<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Demo asistente</title>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />

    <style>
      .form-section {
        display: none; /* Ocultamos todas las secciones */
      }

      .form-section.current {
        display: block; /* Mostramos la sección actual */
      }
    </style>
  </head>

  <body>

    <div class="container">
      <h2 class="text-primary">Registar Venta</h2>

      <div class="row">
        <div class="col-6">
          <form onsubmit="enviarRegistro(); return false;">

            <div class="form-section current">
              <h4>Paso 1: Información Personal</h4>

              <label for="nombre" class="form-label">Nombre:</label>
              <input type="text" id="nombre" name="nombre" class="form-control">

              <label for="email" class="form-label">Email:</label>
              <input type="email" id="email" name="email" class="form-control">

              <div class="row justify-content-end p-0 m-0">
                <button type="button" class="btn btn-outline-info mt-4 col-3 align-self-end" onclick="irProximoPaso()">Siguiente</button>
              </div>
            </div>

            <div class="form-section">
              <h4>Paso 2: Dirección</h4>

              <label for="direccion" class="form-label">Dirección:</label>
              <input type="text" id="direccion" name="direccion" class="form-control">

              <label for="localidad" class="form-label">Localidad:</label>
              <input type="text" id="localidad" name="localidad" class="form-control">

              <label for="codigo-postal" class="form-label">Código Postal:</label>
              <input type="number" id="codigo-postal" name="codigo-postal" class="form-control">

              <div class="row justify-content-between p-0 m-0">
                <button type="button" class="btn btn-outline-info mt-4 col-3" onclick="irAnteriorPaso()">Anterior</button>
                <button type="button" class="btn btn-outline-info mt-4 col-3" onclick="irProximoPaso()">Siguiente</button>
              </div>
            </div>

            <div class="form-section">
              <h4>Paso 3: Información de Pago</h4>

              <label for="numero-tarjeta" class="form-label">Número de Tarjeta:</label>
              <input type="number" id="numero-tarjeta" name="numero-tarjeta" class="form-control">

              <label for="fecha-vencimiento" class="form-label">Fecha de Vencimiento:</label>
              <input type="date" id="fecha-vencimiento" name="fecha-vencimiento" class="form-control">

              <div class="row justify-content-between p-0 m-0">
                <button type="button" class="btn btn-outline-info mt-4 col-3" onclick="irAnteriorPaso()">Anterior</button>
                <button type="submit" class="btn btn-primary mt-4 col-4 align-self-end">Confirmar Pedido</button>
              </div>
            </div>
          </form>
        </div>
      </div>

    </div>

    <script>

      function irProximoPaso() {
        const actual = $(".form-section.current");
        const siguiente = actual.next();

        if (siguiente != null) {
          actual.removeClass("current");
          siguiente.addClass("current");
        }
      }

      function irAnteriorPaso() {
        const actual = $(".form-section.current");
        const anterior = actual.prev();

        if (anterior != null) {
          actual.removeClass("current");
          anterior.addClass("current");
        }
      }

      function validarNombre() {
        let nombre = $("#nombre").val()

        if(nombre.length < 3){
          alert("El nombre debe tener al menos 3 caracteres", "Error");
          return false;
        }
        return true;
      }

      function validarCodigoPostal() {
        let codigo_postal = $("#codigo-postal").val()

        if(codigo_postal.length != 4){
          alert("El código postal debe tener 4 dígitos" );
          return false;
        }
        return true;
      }

      function validarNumeroTarjeta() {
        let numero_tarjeta = $("#numero-tarjeta").val()

        if(numero_tarjeta.length != 16){
          alert("El número de tarjeta debe tener 16 dígitos");
          return false;
        }
        return true;
      }

      function enviarRegistro() {
        if(validarNombre() && 
           validarCodigoPostal() && 
           validarNumeroTarjeta()){
            // Aquí va la lógica para enviar los datos del formulario a través de una API REST
        } else {
          alert("Registro fallido");
        }
      }

      $(document).ready(function() {
        const forms = $('.needs-validation');

        Array.from(forms).forEach(form => {
          $(form).submit(event => {
            if (!$(form).checkValidity()) {
              event.preventDefault()
              event.stopPropagation()
            }

            $(form).addClass('was-validated')
          }, false)
        })
      });
    </script>
  </body>
</html>
